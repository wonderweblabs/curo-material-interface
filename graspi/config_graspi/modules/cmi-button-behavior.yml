webcomponent: true

dependencies:
  - polymer-1.0.8

js:
  coffee:
    options:
      bare: false
      sourceMap: false

tasks:
  graspi_build:
    - graspi_css_sass_compile
    - graspi_css_concat
    - graspi_css_polymer_mixin_replace
    - graspi_js_coffee_compile
    - graspi_js_concat
    - graspi_templates
    - graspi_replace

options:
  # basePath: 'bower_components/cmi/lib/assets/cmi/webcomponents/cmi-button-behavior'
  basePath: 'bower_components/cmi/lib/assets/cmi/webcomponents/cmi-button-behavior'
  destPath: 'graspi_build/cmi-button-behavior/webcomponents'
  css:
    destFile: 'cmi-button-behavior.css'
    files:
      - 'cmi-button-behavior.sass'
  js:
    destFile: 'cmi-button-behavior.js'
    files:
      - cmi-button-behavior.coffee
  templates:
    destFile: 'cmi-button-behavior.html'
    files:
      - cmi-button-behavior.haml
  replace:
    - files:
        - 'graspi_build/cmi-button-behavior/webcomponents/cmi-button-behavior.html'
      pattern:
        pattern: '(\<graspi-webcomponent\-stylesheet\>)'
        modifiers: 'g'
        quotesPlaceholder: 'QUOTES1'
        doubleQuotesPlaceholder: 'QUOTES2'
      replace:
        - '<style is="custom-style">'
        - file: 'graspi_build/cmi-button-behavior/webcomponents/cmi-button-behavior.css'
        - '</style>'
    - files:
        - 'graspi_build/cmi-button-behavior/webcomponents/cmi-button-behavior.html'
      pattern:
        pattern: '(\<graspi\-webcomponent\-script\>)'
        modifiers: 'g'
        quotesPlaceholder: 'QUOTES1'
        doubleQuotesPlaceholder: 'QUOTES2'
      replace:
        - '<script>'
        - file: 'graspi_build/cmi-button-behavior/webcomponents/cmi-button-behavior.js'
        - '</script>'
    - files:
        - 'graspi_build/cmi-button-behavior/webcomponents/cmi-button-behavior.html'
      pattern:
        pattern: '^((?:\/\*)(?:.*)(?:\*\/))$'
        modifiers: 'gm'
        quotesPlaceholder: 'QUOTES1'
        doubleQuotesPlaceholder: 'QUOTES2'
      replace: ''
    - files:
        - 'graspi_build/cmi-button-behavior/webcomponents/cmi-button-behavior.html'
      pattern:
        pattern: '(\n\n)|(^(?:.*)(?:sourceMappingURL)(?:.*))'
        modifiers: 'gm'
        quotesPlaceholder: 'QUOTES1'
        doubleQuotesPlaceholder: 'QUOTES2'
      replace: ''

